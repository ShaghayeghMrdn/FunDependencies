(window.$WP=window.$WP||[]).push({id:"@ta/homepage.homepage-hero",d:["vendor-react-libs","ta-platform","ta-common","@ta/tracking.interactions","@ta/media.video-player","vendor-apollo-libs","vendor-babel","@ta/brand.global-nav-state","@ta/brand.geopill-util","@ta/brand.trip-search-geopill-flyout","@ta/common.geolocation"],e:["./packages/homepage/homepage-hero/homepage-hero.jsx"],x:{"./packages/homepage/homepage-hero/homepage-hero.jsx":["default"],"./roots/brand/trip-search-geopill/TripSearchGeoPill.jsx":["default"]},m:{"./packages/homepage/homepage-hero/homepage-hero.jsx":function(e,o,i){"use strict";i.r(o);var a=i("react"),n=i("@ta/common.api"),t=i("@ta/common.logging"),r=i.n(t),l=i("@ta/media.image"),s=i("@ta/tracking.interactions"),c=i("./roots/brand/trip-search-geopill/TripSearchGeoPill.jsx"),m=i("react-apollo"),p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"LocationThumbnail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"locationIds"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"locationId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnail"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"photoSizes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:192}};p.loc.source={body:"905ccafbedae"};var d=p,h=[{url:"/img2/branding/homepage/cinque_terre_home_1280x250.jpg",width:1280,height:250},{url:"/img2/branding/homepage/cinque_terre_home_2560x500.jpg",width:2560,height:500}],u=function e(o,i,n){return a.createElement(l.ResponsiveImage,{sources:o,backgroundPosition:i,ssrContainerDimensions:n,width:"100%",height:"100%",notLazy:!0})},g=function e(o){var i=o.locationId,n=o.photo,t=o.backgroundPosition,r=o.ssrContainerDimensions;return n&&n.photoSizes?u(n.photoSizes,t,r):i?a.createElement(m.Query,{query:d,variables:{locationId:i}},function(e){var o=e.loading,i=e.data;if(o)return null;var a=i&&i.locations&&i.locations[0]&&i.locations[0].thumbnail&&i.locations[0].thumbnail.photoSizes;return a?u(a):u(h,"50% bottom",r)}):u(h,"50% bottom",r)};g.defaultProps={locationId:void 0,photo:void 0,backgroundPosition:void 0,ssrContainerDimensions:void 0};var v=g,b=i("@ta/media.video-player"),f=function e(o){var i=o.video;return a.createElement("div",{className:"homepage-homepage-hero-HeroVideo__heroVideo--1Gz3j"},a.createElement(b.VideoPlayer,{source:i.sources[0].url,width:"100%",height:"100%",preload:"auto",muted:!0,loop:!0,objectFitCover:!0,transparentBackground:!0,showControls:!1,autopauseEnabled:!1}))},k=i("@ta/common.classnames"),_=i.n(k),N=i("@ta/common.routing"),S=function e(o){var i=o.location;if(!i)return null;var n=i.additionalNamesMap&&i.additionalNamesMap.LONG||i.additionalNames&&i.additionalNames.long,t=i.locationId&&"/Home-g".concat(i.locationId);return n&&t?a.createElement(s.InteractionLogger,null,function(e){return a.createElement(N.Link,{className:"homepage-homepage-hero-GeoPin__geoPin--1Ub4-",href:t,onClick:function o(i){return e(i,"heroGeoPinClick")}},a.createElement("span",{className:_()("homepage-homepage-hero-GeoPin__label--J5Pmd","ui_icon","map-pin-fill")},n))}):null},E=i("@ta/styleguide.avatar"),P=i("@ta/styleguide.icon"),y=i("@ta/common.i18n"),I=function e(o){var i=o.sponsorship,n=i.profile,t=i.profileAvatar;if(!n)return null;var r=i.url,l=!1;r||(r=i.profile&&"/Profile/".concat(i.profile.username),l=!0);var c=a.createElement(a.Fragment,null,a.createElement("div",{className:_()("homepage-homepage-hero-SponsoredProfile__avatar--3yWhT","is-hidden-mobile")},a.createElement(E.Avatar,{key:n.id,photo:t,notLazy:!0})),a.createElement("div",{className:"homepage-homepage-hero-SponsoredProfile__text--2-hkj"},a.createElement("div",{className:"homepage-homepage-hero-SponsoredProfile__sponsoredBy--1bCNd"},Object(y.localize)("insp_sponby")),a.createElement("div",{className:"homepage-homepage-hero-SponsoredProfile__username--39zCu"},n.displayName,l?a.createElement(a.Fragment,null,a.createElement(P.Icon,{name:"verified-fill",className:"homepage-homepage-hero-SponsoredProfile__verified--1j-2O"}),a.createElement(P.Icon,{name:"checkmark",className:"homepage-homepage-hero-SponsoredProfile__checkmark--3MzXe"})):a.createElement(a.Fragment,null,"Â ",a.createElement("span",{className:"homepage-homepage-hero-SponsoredProfile__learnmore--dc8so"},Object(y.localize)("learn_more"),a.createElement(P.Icon,{name:"external-link-no-box",className:"homepage-homepage-hero-SponsoredProfile__external--3nXLS"}))))));return a.createElement(s.InteractionLogger,null,function(e){return l?a.createElement(N.Link,{className:"homepage-homepage-hero-SponsoredProfile__profile--s9rF1",href:r,target:"_self",onClick:function o(i){return e(i,"heroProfileClick")}},c):a.createElement(N.ObfuscatedLink,{className:"homepage-homepage-hero-SponsoredProfile__profile--s9rF1",encodedUrl:r,target:"_blank",onClick:function o(i){return e(i,"heroProfileClick")}},c)})},C=function e(o){var i,n=o.isMobile,t=o.puid,m=o.locationId,p=o.photo,d=o.video,h=o.sponsorship,u=function e(o){if(!o)return!1;var i=o.profile,a=o.photo,n=o.video;return i?i.username?!((!a||!a.photoSizes)&&(n&&n.sources?!n.posterSizes&&(r.a.error("Sponsored homepage hero missing video poster"),1):(r.a.error("Sponsored homepage hero missing photo or video"),1))):(r.a.error("Sponsored homepage hero missing sponsored profile's username"),!1):(r.a.error("Sponsored homepage hero missing sponsored profile"),!1)}(h),g=(u&&h&&h.photo&&h.photo.photoSizes?h.photo:null)||p,b=(u&&h&&h.video&&h.video.sources?h.video:null)||d,k=function e(o,i,a){return a&&Object(l.pickSourceForSize)(o,i,a,{pickImageBasedOnClientInfo:!0,allowedStretch:.25})||{url:"",width:0,height:0}}(1024,250,b&&b.posterSizes||g&&g.photoSizes);k&&k.url&&(i={backgroundImage:"url(".concat(k.url,")")});var _=(h||{}).impressionTrackers,N=void 0===_?[]:_;return a.createElement(s.TrackingNamespaceContext.Provider,{value:"home"},a.createElement(s.HomeTrackingContext.Provider,{value:{uid:t,scopedGeoId:m}},a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__homepageHero--3Hr-G"},a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__hero--2vsJc",style:i},b&&!n?a.createElement(f,{video:b}):a.createElement(v,{photo:g,locationId:m})),a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__geoPill--1HwuN"},a.createElement(c.default,null)),u&&h?a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__sponsor--3JpgJ"},a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__sponsorWrapper--1gauX"},a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__sponsorColumn--3ZeXI"},h.destination?a.createElement(S,{location:h.destination}):null),a.createElement("div",{className:"homepage-homepage-hero-HomepageHero__sponsorColumn--3ZeXI"},a.createElement(I,{sponsorship:h})))):null,N.filter(Boolean).map(function(e){return e.startsWith("https://ad.doubleclick.net/ddm")?a.createElement("img",{className:"homepage-homepage-hero-HomepageHero__trackingPixel--2hvAo",src:e,alt:""}):a.createElement(l.LazyImage,{className:"homepage-homepage-hero-HomepageHero__trackingPixel--2hvAo",src:e,alt:""})}))))};C.defaultProps={locationId:void 0,photo:void 0,video:void 0,sponsorship:void 0};var H=Object(n.bind)(function(e,o){return c.default.stage(e,o),function(){return{isMobile:"MOBILE"===e.meta.device.viewportCategory,puid:e.tracking.uid||""}}})(C),G=function e(o){return a.createElement(H,{locationId:o.locationId,sponsorship:o.sponsorship})};G.defaultProps={sponsorship:void 0},o.default=Object(n.bind)(function(e,o){return H.stage(e,o),function(){return{locationId:e.page.geoId,puid:e.tracking.uid}}})(G)},"./roots/brand/trip-search-geopill/TripSearchGeoPill.jsx":function(e,o,i){"use strict";i.r(o);var a=i("@babel/runtime/helpers/esm/classCallCheck"),n=i.n(a),t=i("@babel/runtime/helpers/esm/createClass"),r=i.n(t),l=i("@babel/runtime/helpers/esm/possibleConstructorReturn"),s=i.n(l),c=i("@babel/runtime/helpers/esm/getPrototypeOf"),m=i.n(c),p=i("@babel/runtime/helpers/esm/inherits"),d=i.n(p),h=i("@babel/runtime/helpers/esm/assertThisInitialized"),u=i.n(h),g=i("@babel/runtime/helpers/esm/defineProperty"),v=i.n(g),b=i("react"),f=i("react-redux"),k=i("@ta/common.i18n"),_=i("@ta/common.is-visible"),N=i("@ta/common.features"),S=i("@ta/common.routing"),E=i("@ta/styleguide.icon"),P=i("@ta/common.tracking"),y=i("@ta/brand.global-nav-state"),I=i("@ta/brand.geopill-util"),C=i("@ta/brand.trip-search-geopill-flyout"),H=i("@ta/common.geolocation"),G=i.n(H),j=function e(){return b.createElement("div",{className:"brand-trip-search-geopill-InDestinationLink__linkWrap--2SWO6"},b.createElement("div",{className:"brand-trip-search-geopill-InDestinationLink__destinationLink--ufpYR",onClick:function e(){G()(function(e,o){var i="/?latitude=".concat(encodeURIComponent("".concat(e)),"&longitude=").concat(encodeURIComponent("".concat(o)),"&isNearby=true");window.location=i},function(){alert(Object(k.localize)("mw_js_positionPermissionDenied")),window.location="/Home"})}},b.createElement("span",{className:"ui_icon nearby-fill"}),Object(k.unescaped)(Object(k.localize)("social_home_im_on_my_trip"))," "))},O=function(e){function o(e){var i;return n()(this,o),i=s()(this,m()(o).call(this,e)),v()(u()(u()(i)),"onVisible",function(){i.props.brandHeaderMounted&&i.props.setTripSearchGeoPillVisible(!0)}),v()(u()(u()(i)),"onInvisible",function(){i.props.brandHeaderMounted&&i.props.setTripSearchGeoPillVisible(!1)}),v()(u()(u()(i)),"containerEl",void 0),i.state={initialVisibilityChecked:!1},i.containerEl=b.createRef(),i}return d()(o,e),r()(o,[{key:"componentDidMount",value:function e(){this.checkVisibilityOnInit()}},{key:"componentDidUpdate",value:function e(){this.checkVisibilityOnInit()}},{key:"checkVisibilityOnInit",value:function e(){if(!this.state.initialVisibilityChecked){var o=this.containerEl.current;o&&this.props.brandHeaderMounted&&(o.getBoundingClientRect().bottom<=0&&this.props.setTripSearchGeoPillVisible(!1),this.setState({initialVisibilityChecked:!0}))}}},{key:"render",value:function e(){var o;return o=this.props.isNearby?Object(k.localize)("mx_nearby"):this.props.isGeoScoped?this.props.geoName:Object(k.localize)("mobile_discovery_where_to"),b.createElement(_.VisibilityObserver,{onVisible:this.onVisible,onInvisible:this.onInvisible,node:this.containerEl,rootMargin:"0px 0px 1000px 0px"},b.createElement(b.Fragment,null,b.createElement("div",{className:"brand-trip-search-geopill-TripSearchGeoPill__container--1pxWN",ref:this.containerEl,"data-test-tripsearch-geopill":!0},b.createElement(P.ClickTracker,{module:"HomeNav_".concat(this.props.servletName),action:"click",context:"GeoPicker"},b.createElement(C.GeoPillRedCarpet,{isGeoScoped:this.props.isGeoScoped,isNearby:this.props.isNearby},function(e){return b.createElement("div",{ref:e,className:"brand-trip-search-geopill-TripSearchGeoPill__pillWrap--2_fwr"},b.createElement("div",{className:"ui_pill ".concat("brand-trip-search-geopill-TripSearchGeoPill__pill--2CF8h")},o,b.createElement(E.Icon,{name:"single-chevron-down",className:"brand-trip-search-geopill-TripSearchGeoPill__icon--2YqBV"})))})),(this.props.isGeoScoped||this.props.isNearby)&&b.createElement(S.Link,{href:"/"},b.createElement("div",{className:"brand-trip-search-geopill-TripSearchGeoPill__unscopeX--I6KUD"},b.createElement(E.Icon,{name:"times",className:"brand-trip-search-geopill-TripSearchGeoPill__icon--2YqBV"})))),!Object(N.featureIsEnabled)("social_in_destination_feed")||this.props.isNearby||this.props.isGeoScoped?null:b.createElement(j,null)))}}]),o}(b.Component);v()(O,"defaultProps",{geoName:void 0}),o.default=Object(f.connect)(function(e){return{brandHeaderMounted:Object(y.getState)(e).brandHeaderMounted}},{setTripSearchGeoPillVisible:y.ACTIONS.setTripSearchGeoPillVisible})(Object(I.TripSearchGeoPillBinding)(O))}}});
//# sourceMappingURL=homepage.homepage-hero.6d07a16d9f.js.map